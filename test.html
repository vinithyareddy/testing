onLoadColumnChart() {
    let ChartOptions = {};
    let xAxisCategory = ['GA', 'GB', 'GC', 'GD', 'GE', 'GF', 'GG', 'GH', 'GI', 'GJ', 'GK', 'GL']; // Extended for demo
  
    const ChartData = [
      {
        name: 'Managerial',
        data: [10, 20, 40, 50, 60, 70, 30, 80, 45, 65, 25, 85], // Extended data
        color: '#71cecd',
      },
      {
        name: 'Technical',
        data: [20, 10, 50, 40, 70, 60, 50, 90, 35, 75, 40, 95], // Extended data
        color: '#6b70af',
      }
    ];
  
    ChartOptions = {
      chartWidth: this.cartboxchartsection.nativeElement.offsetWidth - 40,
      chartHeight: 330,
      xAxisCategory: xAxisCategory,
      legendVisible: false,
      dataseries: ChartData,
      xAxisVisible: true,
      yAxisVisible: true,
      xAxisTitle: 'Grade',
      yAxisTitle: 'Percentage',
      dataLabelEnable: true,
      // Add scroll configuration
      scrollConfig: {
        enabled: true,
        maxCategoriesToShow: 5, // Show 5 categories at a time
        scrollbarHeight: 20
      }
    };
  
    this.swfpColumnChart = this.service.getStackedColumnChart(ChartOptions);
    this.responseFlag = true;
  }


  // Add this to your SwfpByManagerFlagGradeService
getStackedColumnChart(options: any): any[] {
  const scrollConfig = options.scrollConfig || { enabled: false };
  const totalCategories = options.xAxisCategory.length;
  const maxVisible = scrollConfig.maxCategoriesToShow || totalCategories;
  
  const chartOptions = {
    chart: {
      type: 'column',
      width: options.chartWidth,
      height: options.chartHeight,
      backgroundColor: 'transparent',
      margin: [50, 50, 100, 80], // Increased bottom margin for scrollbar
      events: {
        load: function() {
          // Optional: Add custom styling after chart loads
        }
      }
    },
    title: {
      text: null
    },
    xAxis: {
      categories: options.xAxisCategory,
      title: {
        text: options.xAxisTitle || '',
        style: {
          fontSize: '12px',
          fontWeight: '600',
          color: '#666'
        }
      },
      labels: {
        style: {
          fontSize: '11px',
          color: '#666'
        },
        rotation: 0
      },
      // Enable scrollbar if scroll is enabled
      ...(scrollConfig.enabled && totalCategories > maxVisible ? {
        min: 0,
        max: maxVisible - 1,
        scrollbar: {
          enabled: true,
          height: scrollConfig.scrollbarHeight || 20,
          buttonBackgroundColor: '#f0f0f0',
          buttonBorderColor: '#ccc',
          rifleColor: '#666',
          trackBackgroundColor: '#f8f8f8',
          trackBorderColor: '#ccc'
        },
        tickInterval: 1
      } : {})
    },
    yAxis: {
      title: {
        text: options.yAxisTitle || '',
        style: {
          fontSize: '12px',
          fontWeight: '600',
          color: '#666'
        }
      },
      labels: {
        style: {
          fontSize: '11px',
          color: '#666'
        }
      },
      gridLineColor: '#e6e6e6',
      gridLineWidth: 1,
      // Keep Y-axis fixed
      min: 0,
      tickInterval: 10 // Adjust as needed
    },
    plotOptions: {
      column: {
        stacking: 'normal', // or 'percent' for percentage stacking
        borderWidth: 0,
        pointPadding: 0.1,
        groupPadding: 0.1,
        dataLabels: {
          enabled: options.dataLabelEnable || false,
          style: {
            fontSize: '10px',
            fontWeight: '600',
            color: '#333',
            textOutline: 'none'
          },
          formatter: function() {
            return this.y > 0 ? this.y : '';
          }
        }
      }
    },
    legend: {
      enabled: options.legendVisible || false
    },
    tooltip: {
      shared: true,
      useHTML: true,
      backgroundColor: 'rgba(255, 255, 255, 0.95)',
      borderColor: '#ccc',
      borderRadius: 6,
      shadow: true,
      style: {
        fontSize: '11px'
      },
      formatter: function() {
        let tooltip = `<b>${this.x}</b><br/>`;
        this.points.forEach(point => {
          tooltip += `<span style="color: ${point.color}">‚óè</span> ${point.series.name}: <b>${point.y}</b><br/>`;
        });
        return tooltip;
      }
    },
    series: options.dataseries,
    credits: {
      enabled: false
    },
    exporting: {
      enabled: false
    },
    // Enable navigation for scrolling
    ...(scrollConfig.enabled ? {
      navigation: {
        buttonOptions: {
          enabled: false
        }
      }
    } : {})
  };

  return [{
    Highcharts: require('highcharts'),
    chartOptions: chartOptions,
    chartConstructor: 'chart'
  }];
}

// Add this to your existing SCSS file

// Custom scrollbar styling for Highcharts
:host ::ng-deep {
  .highcharts-scrollbar-track {
    fill: #f8f9fa;
    stroke: #dee2e6;
    stroke-width: 1;
    rx: 3;
  }
  
  .highcharts-scrollbar-thumb {
    fill: #6c757d;
    stroke: #495057;
    stroke-width: 1;
    rx: 3;
    
    &:hover {
      fill: #495057;
    }
  }
  
  .highcharts-scrollbar-button {
    fill: #f8f9fa;
    stroke: #dee2e6;
    stroke-width: 1;
    
    &:hover {
      fill: #e9ecef;
    }
  }
  
  .highcharts-scrollbar-rifles {
    stroke: #6c757d;
    stroke-width: 1;
  }
  
  // Ensure chart container has proper overflow handling
  .highcharts-container {
    overflow: visible;
  }
}

// Optional: Add some spacing for the chart container when scrollbar is present
.inner-card-box {
  .col-md-12 {
    padding-bottom: 20px; // Extra space for scrollbar
  }
}