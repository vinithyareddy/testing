getStackedColumnChart(ChartOptions: any) {
    const outsidethis = this;
    const ChartValues: any = [];

    // ADD THIS: Check if scroll configuration exists
    const scrollConfig = ChartOptions.scrollConfig || { enabled: false };
    const totalCategories = ChartOptions.xAxisCategory.length;
    const maxVisible = scrollConfig.maxCategoriesToShow || totalCategories;

    ChartValues.push({
        Highcharts: Highcharts,
        chartConstructor: 'chart',
        chartOptions: {
            title: {
                text: ''
            },
            chart: {
                type: 'column',
                width: ChartOptions.chartWidth,
                height: ChartOptions.chartHeight,
                backgroundColor: '#ffffff',
                plotBackgroundColor: '#ffffff',
                plotBorderWidth: 1,
                // ADD THIS: Increase bottom margin when scrollbar is enabled
                ...(scrollConfig.enabled ? { margin: [null, null, 100, null] } : {})
            },
            xAxis: {
                categories: ChartOptions.xAxisCategory,
                title: {
                    text: ChartOptions.xAxisTitle
                },
                // ADD THIS ENTIRE SECTION: Conditional scrollbar configuration
                ...(scrollConfig.enabled && totalCategories > maxVisible ? {
                    min: 0,
                    max: maxVisible - 1,
                    scrollbar: {
                        enabled: true,
                        height: scrollConfig.scrollbarHeight || 20,
                        buttonBackgroundColor: '#f0f0f0',
                        buttonBorderColor: '#ccc',
                        buttonArrowColor: '#666',
                        buttonBorderWidth: 1,
                        rifleColor: '#666',
                        trackBackgroundColor: '#f8f8f8',
                        trackBorderColor: '#ccc',
                        trackBorderWidth: 1,
                        barBackgroundColor: '#c1c7d0',
                        barBorderColor: '#999',
                        barBorderWidth: 1
                    },
                    tickInterval: 1
                } : {})
            },
            yAxis: [{
                min: 0,
                title: {
                    text: ChartOptions.yAxisTitle ? ChartOptions.yAxisTitle : 'Percentage'
                },
                stackLabels: {
                    // Your existing stackLabels config
                },
                // ADD THIS: Fixed Y-axis interval for consistency
                tickInterval: 20 // Adjust this value as needed
            },
            {
                title: {
                    text: ChartOptions.title,
                },
                opposite: true
            }],
            tooltip: {
                pointFormat: '{series.name}: <b>{point.y:,.1f}</b>',
                outside: true
            },
            plotOptions: {
                column: {
                    stacking: 'normal',
                    pointWidth: 25
                }
            },
            legend: {
                enabled: ChartOptions.legendVisible,
            },
            series: ChartOptions.dataseries,
            credits: {
                enabled: false
            },
            // ADD THIS: Enable navigation for scrollbar functionality
            ...(scrollConfig.enabled ? {
                navigation: {
                    buttonOptions: {
                        enabled: false
                    }
                }
            } : {})
        } as Highcharts.Options
    });

    return ChartValues;
}